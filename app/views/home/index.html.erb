<% unless user_signed_in? %>
<h1>Welcome to the IBEST FileBox</h1>
<p>
	File sharing web application you can't ignore.
</p>
<% else %>
<%= render :partial => "breadcrumbs" %>

<div class="asset_list_header">
	<div class="file_name_header">
		File Name
	</div>
	<div class="file_size_header">
		Size
	</div>
	<div class="file_last_updated_header">
		Modified
	</div>
</div>
<div class="asset_list">

	<!-- Listing Shared Folders (the folders shared by others) -->
	<% @being_shared_folders.each do |folder| %>
	<div class="asset_details <%= folder.shared? ? 'shared_folder' : 'folder' %>" id="folder_<%= folder.id %>">
		<div class="file_name">
			<%= link_to folder.name, browse_path(folder) %>
		</div>
		<div class="file_size">
			-
		</div>
		<div class="file_last_updated">
			-
		</div>
		<div class="actions">
		</div>
	</div>
	<% end %>

	<!-- Listing Folders -->
	<% @folders.each do |folder| %>
	<div class="asset_details <%= folder.shared? ? 'shared_folder' : 'folder' %>" id="folder_<%= folder.id %>">

		<div class="file_name">
			<%= link_to truncate(folder.name, :length => 50), browse_path(folder) %>
		</div>
		<div class="file_size">
			<%= pluralize(folder.number_of_files, 'File') %>
		</div>
		<div class="file_last_updated">
			<%= folder.last_updated %>
		</div>
		<div class="actions">
			<% if folder.is_public? %>
			<div class="public">
				<% if folder.parent.nil? %>
				<%= link_to "Set Private", publicize_path(folder) unless @is_this_folder_being_shared %>
				<% elsif folder.parent.is_public? %>
				<!-- Parent is public -->
				<% else %>
				<%= link_to "Set Private", publicize_path(folder) unless @is_this_folder_being_shared %>
				<% end %>
			</div>
			<% else %>
			<div class="private">
				<%= link_to "Set Public", publicize_path(folder) unless @is_this_folder_being_shared %>
			</div>
			<% end %>
			<div class="rename">
				<%= link_to "Rename", rename_folder_path(folder) unless @is_this_folder_being_shared %>
			</div>
			<div class="delete">
				<%= link_to "Delete", folder, :confirm => 'Are you sure to delete the folder and all of its contents?', :method => :delete unless @is_this_folder_being_shared %>
			</div>
			<div class="share">
				<%= link_to "Share", "#", :folder_id => folder.id, :folder_name => folder.name unless @is_this_folder_being_shared %>
			</div>
		</div>
	</div>
	<% end %>

	<% @assets.each do |asset| %>
	<div class="asset_details file">
		<div class="file_name">
			<%= link_to truncate(asset.file_name, :length => 50), download_path(asset) %>
		</div>
		<div class="file_size">
			<%= number_to_human_size(asset.file_size, :precision => 2) %>
		</div>
		<div class="file_last_updated">
			<%= asset.uploaded_file_updated_at %>
		</div>
		<div class="actions">
			<div class="download">
				<%= link_to "Download", download_path(asset) unless @is_this_folder_being_shared %>
			</div>
			<div class="delete">
				<%= link_to "Delete", asset, :confirm => 'Are you sure?', :method => :delete unless @is_this_folder_being_shared %>
			</div>
		</div>
	</div>
	<% end %>
</div> <!-- Asset list -->
<div id="invitation_form" title="Invite others to share" style="display:none">
	<%= form_tag '/home/share' do %>
	<label for="email_addresses">
		Enter recipient email addresses here
		<br />
		<i style="font-weight: normal;">Seperate multiple addresses with a comma</i>
	</label>
	<br />
	<%= text_area_tag 'email_addresses', "", :class => 'text ui-widget-content ui-corner-all'%>
	<br />
	<br />
	<label for="message">
		Optional message
	</label>
	<br />
	<%= text_area_tag 'message',"",  :class => 'text ui-widget-content ui-corner-all'%>
	<%= hidden_field_tag "folder_id" %>
	<% end %>
</div>
<% end %>

